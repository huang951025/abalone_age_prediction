# -*- coding: utf-8 -*-
"""Cool.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1p1i_RdzC1sA4HsJuYVhIx693w4g_V-hh
"""

import sys
import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib
import matplotlib.pyplot as plt  
from sklearn import datasets
from sklearn.tree import DecisionTreeClassifier
from sklearn.model_selection import train_test_split
from sklearn.metrics import confusion_matrix
from sklearn.tree import DecisionTreeRegressor   
from sklearn.model_selection import cross_val_score   
from collections import OrderedDict
import tensorflow as tf
import keras
from numpy import array
from numpy import argmax
from sklearn.preprocessing import LabelEncoder
from sklearn.preprocessing import OneHotEncoder

abalone_df = pd.read_csv('abalone.csv',header = 0)
abalone_df.isnull().any()
abalone_df[abalone_df.isnull().values == True]
abalone_df = abalone_df[abalone_df['Viscera_weight'] != 'c']

# M:2, F:0, I:1
def coonvertSex(x):
  if x == "M":
    return 0
  elif x == "F":
    return 1
  elif x == "I":
    return 2
  else:
    return x
abalone_df['Sex'] = abalone_df['Sex'].apply(coonvertSex)
abalone_df

labels = abalone_df['Rings']
features = abalone_df[abalone_df.columns[0:8]]
features

plt.hist(labels,color = 'red',edgecolor='k')
plt.xlabel('range of perf')
plt.ylabel('Frequency')
plt.title('Histgrom of perf')
plt.show()

sns.distplot(np.log(labels), color='red')
plt.xlabel('range of ln(perf)')
plt.ylabel('Frequency')
plt.title('Histgrom of ln(perf)')
plt.show()

abalone_df

from sklearn.model_selection import train_test_split
X_train, X_test, Y_train, Y_test = train_test_split(features, labels, random_state = 14, test_size = 0.2)

"""# Next part is the linear regression"""

from sklearn.linear_model import LinearRegression

reg = LinearRegression()
reg.fit(X_train, Y_train)
Y_pre = reg.predict(X_test)
MSE = np.mean((Y_test - Y_pre)**2)
score = reg.score(X_test,Y_test)
print('MSE=%f'%MSE)
print('SCORE=%f'%score)